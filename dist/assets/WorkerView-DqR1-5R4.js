import{d as y,I as b,a as W,b as A,c as V,e as N,f as $,g as z,h as P,i as q,_ as T,r as a,o as l,j as O,w as e,k as t,l as r,t as d,m as p,n as o,F as R,p as U,q as g,s as j,u as H}from"./index-yANS5MSY.js";const L=y({components:{IonButtons:b,IonSelect:W,IonSelectOption:A,IonContent:V,IonHeader:N,IonMenuButton:$,IonPage:z,IonTitle:P,IonToolbar:q},data(){return{stage:"workspaceSelection",workplaceIdInput:-1,currentVisitor:-1}},mounted(){localStorage.getItem("workspaceSetting_WorkerID")&&Number(localStorage.getItem("workspaceSetting_WorkerID"))>-1&&(this.stage="workspaceDesk",this.workspaceSetting_WorkerID=Number(localStorage.getItem("workspaceSetting_WorkerID")))},methods:{selectWorkplace(){if(Number(this.workplaceIdInput)>-1){var u=Number(this.workplaceIdInput);this.workspaceSetting_WorkerID=u,localStorage.setItem("workspaceSetting_WorkerID",u+"")}else console.log("Please, select correct value for the workplace's ID.",Number(this.workplaceIdInput))},workplaceSelectorNewValue(u){this.workspaceSetting_WorkerID=Number(u.detail.value)},catchNewRequest(){this.$axios.get(localStorage.getItem("APIServer_InstanceAddress")+"/queue/catch",{params:{id:this.workspaceSetting_WorkerID,workerId:this.workspaceSetting_WorkerID}}).then(u=>{if(u.data.status=="AddedToFreeWorkers"){this.stage="workspaceIsFreeOfWork";const s=setInterval(()=>{this.$axios.get(localStorage.getItem("APIServer_InstanceAddress")+"/queue/catch",{params:{id:this.workspaceSetting_WorkerID,workerId:this.workspaceSetting_WorkerID}}).then(_=>{_.data.status=="Assigned"&&(clearInterval(s),this.currentVisitor=_.data.key,this.stage="awaitingForVisitor")}).catch(_=>{console.error(_)})},4e3)}else u.data.status=="Assigned"&&(this.currentVisitor=u.data.key,this.stage="awaitingForVisitor")}).catch(u=>{console.error(u)})},acceptArbitrary(){this.$axios.get(localStorage.getItem("APIServer_InstanceAddress")+"/queue/acceptArbitrary",{params:{id:this.workspaceSetting_WorkerID}}).then(u=>{u.data.status=="InProgress"&&(this.currentVisitor=u.data.visitorId,this.stage="InProgress")}).catch(u=>{console.error(u)})},updateStatus(u){this.$axios.get(localStorage.getItem("APIServer_InstanceAddress")+"/queue/updateStatus",{params:{id:this.currentVisitor,newStatus:u}}).then(s=>{s.data.status=="Updated"&&(this.stage="InProgress",u=="Finished"&&(this.stage="workspaceDesk"),u=="CanceledByWorker"&&(this.stage="workspaceDesk"))}).catch(s=>{console.error(s)})}}}),n=u=>(j("data-v-38c362e0"),u=u(),H(),u),M={key:0},G=n(()=>o("strong",{class:"capitalize"},"Выбор оператора",-1)),J=n(()=>o("p",null,"Выберите оператора, за которого вы работаете",-1)),K={style:{width:"50%","max-width":"90vw",margin:"auto"}},Q={key:1,style:{"margin-left":"5vw"}},X={style:{background:"#00000010","border-radius":"20px",height:"auto",padding:"10px",width:"180px","margin-left":"5px","margin-bottom":"10vh"}},Y={class:"capitalize",style:{"padding-bottom":"15px"}},Z=n(()=>o("strong",{class:"capitalize"},"Следующий посетитель",-1)),x=n(()=>o("p",null,"Уже готовы к следующему посетителю?",-1)),u4=n(()=>o("strong",{class:"capitalize"},"Принять вне очереди",-1)),e4=n(()=>o("p",null,"Принимаете посетителя вне очереди?",-1)),t4={key:2,id:"container"},o4=n(()=>o("strong",{class:"capitalize"},"Ждем!",-1)),s4=n(()=>o("p",null,"Сейчас нет посетителей, которых можно бы было взять",-1)),a4=n(()=>o("p",null,"Когда появятся посетители - они будут распределены вам.",-1)),n4=[o4,s4,a4],r4={key:3,id:"container"},i4={class:"capitalize"},l4=n(()=>o("p",null,"Посетитель вызван к вам",-1)),c4={key:4,id:"container"},d4={class:"capitalize"},p4=n(()=>o("p",null,"Вы работаете с этим посетителем сейчас",-1));function _4(u,s,_,g4,h4,k4){const E=a("ion-menu-button"),C=a("ion-buttons"),k=a("ion-title"),m=a("ion-toolbar"),I=a("ion-header"),F=a("ion-select-option"),B=a("ion-select"),S=a("ion-item"),c=a("ion-button"),h=a("ion-col"),f=a("ion-row"),w=a("ion-grid"),v=a("ion-content"),D=a("ion-page");return l(),O(D,null,{default:e(()=>[t(I,{translucent:!0},{default:e(()=>[t(m,null,{default:e(()=>[t(C,{slot:"start"},{default:e(()=>[t(E,{color:"primary"})]),_:1}),t(k,null,{default:e(()=>[r(d(u.$route.params.id),1)]),_:1})]),_:1})]),_:1}),t(v,{fullscreen:!0},{default:e(()=>[t(I,{collapse:"condense"},{default:e(()=>[t(m,null,{default:e(()=>[t(k,{size:"large"},{default:e(()=>[r(d(u.$route.params.id),1)]),_:1})]),_:1})]),_:1}),u.stage=="workspaceSelection"?(l(),p("div",M,[G,J,o("div",K,[t(S,{style:{"margin-top":"5vh"}},{default:e(()=>[t(B,{label:"Оператор",placeholder:"Выберите",modelValue:u.workplaceIdInput,"onUpdate:modelValue":s[0]||(s[0]=i=>u.workplaceIdInput=i),onIonChange:u.workplaceSelectorNewValue},{default:e(()=>[(l(),p(R,null,U(100,i=>t(F,{key:i,value:i},{default:e(()=>[r(d(i),1)]),_:2},1032,["value"])),64))]),_:1},8,["modelValue","onIonChange"])]),_:1}),t(c,{style:{"margin-top":"5vh"},onClick:u.selectWorkplace},{default:e(()=>[r("Продолжить")]),_:1},8,["onClick"])])])):g("",!0),u.stage=="workspaceDesk"?(l(),p("div",Q,[o("div",X,[o("strong",Y,"Рабочее место "+d(u.workspaceSetting_WorkerID),1)]),t(w,null,{default:e(()=>[t(f,null,{default:e(()=>[t(h,{size:"6"},{default:e(()=>[Z,x,t(c,{onClick:u.catchNewRequest,style:{"margin-top":"2vh","margin-left":"-4px"}},{default:e(()=>[r("Позвать следующего посетителя")]),_:1},8,["onClick"])]),_:1}),t(h,{size:"6"},{default:e(()=>[u4,e4,t(c,{onClick:u.acceptArbitrary,style:{"margin-top":"2vh","margin-left":"-4px"}},{default:e(()=>[r("Принять вне очереди")]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1})])):g("",!0),u.stage=="workspaceIsFreeOfWork"?(l(),p("div",t4,n4)):g("",!0),u.stage=="awaitingForVisitor"?(l(),p("div",r4,[o("strong",i4,"В пути посетитель №"+d(u.currentVisitor),1),l4,t(w,{style:{"margin-top":"5vh",width:"65vw"}},{default:e(()=>[t(f,null,{default:e(()=>[t(h,{size:"6"},{default:e(()=>[t(c,{onClick:s[1]||(s[1]=i=>u.updateStatus("CanceledByWorker")),style:{"margin-left":"-4px",opacity:"0.8"},color:"danger"},{default:e(()=>[r("Не пришел, отменить")]),_:1})]),_:1}),t(h,{size:"6"},{default:e(()=>[t(c,{onClick:s[2]||(s[2]=i=>u.updateStatus("InProgress")),style:{"margin-left":"-4px"}},{default:e(()=>[r("Пришел, начать работу")]),_:1})]),_:1})]),_:1})]),_:1})])):g("",!0),u.stage=="InProgress"?(l(),p("div",c4,[o("strong",d4,"Ваш посетитель №"+d(u.currentVisitor),1),p4,t(c,{onClick:s[3]||(s[3]=i=>u.updateStatus("Finished")),style:{"margin-top":"5vh","margin-left":"-4px"}},{default:e(()=>[r("Мы закончили, завершить")]),_:1})])):g("",!0)]),_:1})]),_:1})}const I4=T(L,[["render",_4],["__scopeId","data-v-38c362e0"]]);export{I4 as default};
